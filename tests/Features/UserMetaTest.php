<?php

namespace CityHunter\LaravelMetaData\Tests\Features;

use CityHunter\LaravelMetaData\Tests\Factories\UserFactory;
use CityHunter\LaravelMetaData\Tests\Factories\UserMetaFactory;
use CityHunter\LaravelMetaData\Tests\Models\User;
use CityHunter\LaravelMetaData\Tests\Models\UserMeta;
use CityHunter\LaravelMetaData\Tests\TestCase;

class UserMetaTest extends TestCase
{

    public function setUp(): void
    {
        parent::setUp(); // TODO: Change the autogenerated stub
    }


    public function test_get_user_metas()
    {
        $user = UserFactory::new()->create();
        UserMetaFactory::new()->set("user_id", $user->id)->create();
        $this->assertTrue(UserMeta::all()->count() === 1);

        $this->assertSame(1, count(\get_user_meta($user->id)));

        \add_user_meta($user->id, "test_key", "test_value");
        $this->assertSame(2, count(\get_user_meta($user->id)));

        $this->assertTrue(is_array(\get_user_meta($user->id, "test_key")->all()));
        $this->assertTrue(is_object(\get_user_meta($user->id, "test_key", true)));
    }
}
